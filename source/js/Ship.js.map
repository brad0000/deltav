{"version":3,"sources":["Ship.ts"],"names":[],"mappings":"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","file":"Ship.js","sourcesContent":["namespace deltav {\r\n    \r\n    export class Ship extends Body {\r\n\r\n        protected power = 20000;\r\n        protected angularPower = 20000;\r\n        protected weaponGroups: WeaponGroup[];\r\n        protected engines: Engine[];\r\n        \r\n        protected img: HTMLImageElement;\r\n\r\n        constructor(logger: Logger, position: Vector) {\r\n            super(logger, position);\r\n\r\n            this.mass = 10;\r\n            this.radius = 50;\r\n\r\n            this.brush = \"red\";\r\n\r\n            this.velocity = Vector.create([0, 1]);\r\n\r\n            let geo = [\r\n                Vector.create([-2, -3]), // back of wing\r\n                Vector.create([0, -3]),\r\n                Vector.create([1, -1]),\r\n                Vector.create([4, -.8]), // top right nose\r\n                Vector.create([4, .8]),\r\n                Vector.create([1, 1]),\r\n                Vector.create([0, 3]),\r\n                Vector.create([-2, 3]), // back of wing\r\n                Vector.create([-1.5, 1]),\r\n                Vector.create([-2, 1]),\r\n                Vector.create([-2, -1]),\r\n                Vector.create([-1.5, -1]),\r\n            ];\r\n\r\n            for (let i = 0; i < geo.length; i++) {\r\n                geo[i] = geo[i].multiply(5);\r\n            }\r\n\r\n            this.setGeometry(geo);\r\n        }\r\n\r\n        public update(time: number, world: World, input: IInput): boolean {\r\n            let moved = super.update(time, world, input);\r\n\r\n            let speed = this.velocity.modulus();\r\n            if (speed > 1) {\r\n                this.heading = this.velocity.toAngle();\r\n            }\r\n\r\n            for (let i = 0; i < this.weaponGroups.length; i++) {\r\n                this.weaponGroups[i].update(time);\r\n            }\r\n\r\n            if (input.isDown(CtlKey.WeaponGroup1) && this.weaponGroups[0].ready()) {\r\n                this.weaponGroups[0].fire(world, this.position, this.velocity);\r\n            }\r\n            \r\n            if (input.isDown(CtlKey.WeaponGroup2) && this.weaponGroups[1].ready()) {\r\n                this.weaponGroups[1].fire(world, this.position, this.velocity);\r\n            }\r\n\r\n            // calc net forces\r\n            let force = Vector.Zero(2);\r\n            let directionVector = Vector.create([1, 0]).rotate(this.heading, Vector.Zero(2));\r\n\r\n            if (input.isDown(CtlKey.Accelerate)) {\r\n                \r\n                let throttle = input.rate(CtlKey.Accelerate);\r\n                force = force.add(directionVector.multiply(throttle * this.power));\r\n\r\n                for (let i = 0; i < this.engines.length; i++) {\r\n                    this.engines[i].update(world);\r\n                }\r\n\r\n            } else if (input.isDown(CtlKey.Brake)) {\r\n                let brake = input.rate(CtlKey.Brake);\r\n                force = force.add(directionVector.multiply(-1).multiply(brake * this.power));\r\n            }\r\n            \r\n            // newton\r\n            this.acceleration = force.divide(this.mass).multiply(time);\r\n\r\n            // change heading\r\n            let veerRight = input.isDown(CtlKey.Clockwise);\r\n            let veerLeft = input.isDown(CtlKey.AntiClockwise);\r\n            let rotation: Vector = null;\r\n            if (veerRight || veerLeft) {\r\n                \r\n                let rate = input.rate(veerLeft ? CtlKey.AntiClockwise : CtlKey.Clockwise);\r\n                \r\n                rotation = this.velocity\r\n                    .rotate(Math.PI / 2 * (veerRight ? 1 : -1), Vector.Zero(2))\r\n                    .toUnitVector()\r\n                    .multiply(this.angularPower * rate)\r\n                    .multiply(time);\r\n                    \r\n                this.acceleration = this.acceleration.add(rotation);\r\n\r\n                // let rad = Math.PI / 2 * (veerRight ? -1 : 1);\r\n                // let exhaust = this.position.add(Vector.create([4, 0]).rotate(this.heading, this.position));\r\n                // world.bodies.push(\r\n                //     new Smoke(this, exhaust.e(1), exhaust.e(2), this.velocity.rotate(rad, this.velocity)));\r\n            }\r\n            \r\n            return moved;\r\n        }\r\n\r\n        public report(): string {\r\n            return \"p \" + this.fv(this.position, 0)\r\n                + \" h \" + this.fh(this.velocity.toAngle())\r\n                + \" v \" + this.velocity.modulus().toFixed(2)\r\n                + \" a \" + this.acceleration.modulus().toFixed(2);\r\n        }\r\n\r\n        public render(ctx: CanvasRenderingContext2D) {\r\n            \r\n            if (this.img == null) {\r\n                super.render(ctx);\r\n            } else {\r\n                \r\n                // supposedly these are expensive:\r\n                // ctx.save();\r\n                // ctx.restore();\r\n                \r\n                ctx.translate(this.getX(), this.getY());\r\n                ctx.rotate(this.heading);\r\n                ctx.drawImage(this.img, -this.radius, -this.radius / 2, this.radius * 2, this.radius);\r\n                ctx.rotate(-this.heading);\r\n                ctx.translate(-this.getX(), -this.getY());\r\n                \r\n            }\r\n\r\n            // if  (this.velocity.modulus() > 0.5) {\r\n            //     ctx.beginPath();\r\n            //     ctx.strokeStyle = \"red\";\r\n            //     ctx.moveTo(this.getX(), this.getY());\r\n            //     let endOfLine = this.position.add(this.velocity.toUnitVector().multiply(this.mass * 2));\r\n            //     ctx.lineTo(endOfLine.e(1), endOfLine.e(2));\r\n            //     ctx.stroke();\r\n            // }\r\n\r\n            // logging\r\n            ctx.beginPath();\r\n            ctx.fillStyle = \"white\";\r\n            ctx.font = \"10px Arial\";\r\n            ctx.fillText((this.health * 100).toFixed(0), this.getX() - 10, this.getY() - 20);\r\n            ctx.fill();\r\n        }\r\n\r\n        public recentlyFired(bullet: Bullet): boolean {\r\n            for (let i = 0; i < this.weaponGroups.length; i++) {\r\n                if (this.weaponGroups[i].recentlyFired(bullet)) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n\r\n        // private scaleAngularPower(speed: number): number {\r\n        //     return this.angularPower * speed;\r\n        // }\r\n\r\n        private fh(rad: number): string {\r\n            let deg = rad * 180 / Math.PI;\r\n            return deg.toFixed(0);\r\n        }\r\n\r\n        private fv(v: Vector, dp: number): string {\r\n            let e = v.elements;\r\n            return e[0].toFixed(dp) + \", \" + e[1].toFixed(dp);\r\n        }\r\n    }\r\n    \r\n        export class Hornet extends Ship {\r\n        constructor(logger: Logger, position: Vector) {\r\n            super(logger, position);\r\n\r\n                this.img = <HTMLImageElement>document.images.namedItem(\"hornet\");\r\n                this.mass = 10;\r\n                this.radius = 30;\r\n            \r\n                this.weaponGroups = [\r\n                    new WeaponGroup(this.logger, this, [ new GattlingGun(this, Vector.create([this.radius, 0])) ]),\r\n                    new WeaponGroup(this.logger, this, [ new Canon(this, Vector.create([this.radius, 0])) ]),\r\n                ];\r\n                \r\n                this.engines = [\r\n                    new Engine(this.logger, this, Vector.create([-this.radius + 5, 0])),  \r\n                ];\r\n        }\r\n    }\r\n    \r\n    export class Constellation extends Ship {\r\n        constructor(logger: Logger, position: Vector) {\r\n            super(logger, position);\r\n\r\n                this.img = <HTMLImageElement>document.images.namedItem(\"constellation\");\r\n                this.mass = 38;\r\n                this.radius = 85;\r\n                this.power = 50000;\r\n                this.angularPower = 10000;\r\n\r\n                this.weaponGroups = [\r\n                    new WeaponGroup(this.logger, this, [ \r\n                        new GattlingGun(this, Vector.create([0, -20])),\r\n                        new GattlingGun(this, Vector.create([0, 20])),\r\n                    ]),\r\n                    new WeaponGroup(this.logger, this, [ new Canon(this, Vector.create([this.radius, 0])) ]),\r\n                ];\r\n\r\n                this.engines = [\r\n                    new Engine(this.logger, this, Vector.create([-this.radius + 5, 20])),  \r\n                    new Engine(this.logger, this, Vector.create([-this.radius + 5, -20])),\r\n                ];\r\n        }\r\n    }\r\n    \r\n    export class Engine {\r\n        constructor(private logger: Logger, private ship: Ship, private position: Vector) {\r\n            \r\n        }\r\n        \r\n        public update(world: World) {\r\n            \r\n            let shipPosition = this.ship.getP();\r\n            let exhaust = shipPosition.add(this.position).rotate(this.ship.getH(), shipPosition);\r\n            \r\n            world.addStaticBody(new Smoke(this.logger, exhaust, Vector.Zero(2), 1));\r\n        }\r\n    }\r\n\r\n}\r\n"],"sourceRoot":"/source/"}